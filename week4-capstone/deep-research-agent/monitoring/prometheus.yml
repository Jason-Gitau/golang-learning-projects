# Prometheus Configuration for Deep Research Agent
# =================================================================

global:
  scrape_interval: 15s       # Scrape targets every 15 seconds
  evaluation_interval: 15s   # Evaluate rules every 15 seconds
  scrape_timeout: 10s

  # Attach these labels to any time series or alerts
  external_labels:
    monitor: 'deep-research-agent'
    environment: 'development'

# Alertmanager configuration (optional - can be added later)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets: []

# Load rules once and periodically evaluate them
# rule_files:
#   - "rules/*.yml"

# Scrape configurations
scrape_configs:
  # =================================================================
  # Prometheus itself (self-monitoring)
  # =================================================================
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
        labels:
          service: 'prometheus'

  # =================================================================
  # Research Agent API
  # =================================================================
  - job_name: 'research-agent'
    metrics_path: '/metrics'  # If you add metrics endpoint
    static_configs:
      - targets: ['research-agent:8080']
        labels:
          service: 'research-agent'
          app: 'deep-research-agent'
    # Optional: scrape agent health
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'research-agent'

  # =================================================================
  # Research Agent Health Endpoint (alternative monitoring)
  # =================================================================
  - job_name: 'research-agent-health'
    metrics_path: '/health'
    static_configs:
      - targets: ['research-agent:8080']
        labels:
          service: 'research-agent-health'
          check_type: 'health'
    scrape_interval: 30s

  # =================================================================
  # Docker Container Metrics (if cAdvisor is added)
  # =================================================================
  # - job_name: 'cadvisor'
  #   static_configs:
  #     - targets: ['cadvisor:8080']
  #       labels:
  #         service: 'cadvisor'

  # =================================================================
  # Node Exporter (if added for system metrics)
  # =================================================================
  # - job_name: 'node-exporter'
  #   static_configs:
  #     - targets: ['node-exporter:9100']
  #       labels:
  #         service: 'node-exporter'
