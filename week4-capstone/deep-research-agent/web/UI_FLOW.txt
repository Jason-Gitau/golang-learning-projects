╔══════════════════════════════════════════════════════════════════════════════╗
║                    DEEP RESEARCH AGENT - WEB UI FLOW                         ║
╚══════════════════════════════════════════════════════════════════════════════╝

                              ┌─────────────────┐
                              │  User Visits    │
                              │ localhost:8080  │
                              └────────┬────────┘
                                       │
                    ┌──────────────────┴──────────────────┐
                    │      Is User Authenticated?         │
                    └──────────┬──────────────────┬───────┘
                               │                  │
                        ┌──────┴──────┐    ┌─────┴──────┐
                        │     NO      │    │    YES     │
                        └──────┬──────┘    └─────┬──────┘
                               │                  │
                    ┌──────────▼──────────┐       │
                    │  LOGIN/REGISTER     │       │
                    │      PAGE           │       │
                    │                     │       │
                    │  ┌───────────────┐  │       │
                    │  │ - Login Form  │  │       │
                    │  │ - Register    │  │       │
                    │  │   Form        │  │       │
                    │  └───────────────┘  │       │
                    └──────────┬──────────┘       │
                               │                  │
                    ┌──────────▼──────────┐       │
                    │  User Submits Form  │       │
                    └──────────┬──────────┘       │
                               │                  │
                    ┌──────────▼──────────┐       │
                    │ POST /api/v1/auth/  │       │
                    │   login or register │       │
                    └──────────┬──────────┘       │
                               │                  │
                    ┌──────────▼──────────┐       │
                    │  JWT Token Stored   │       │
                    │  in localStorage    │       │
                    └──────────┬──────────┘       │
                               │                  │
                               └──────────┬───────┘
                                          │
                               ┌──────────▼───────────┐
                               │     DASHBOARD        │
                               │   (Main Interface)   │
                               └──────────┬───────────┘
                                          │
                    ┌─────────────────────┼─────────────────────┐
                    │                     │                     │
         ┌──────────▼──────────┐ ┌───────▼────────┐  ┌────────▼────────┐
         │  NEW RESEARCH TAB   │ │ ACTIVE RESEARCH│  │   SESSIONS TAB  │
         └──────────┬──────────┘ │      TAB       │  └────────┬────────┘
                    │             └───────┬────────┘           │
         ┌──────────▼──────────┐         │          ┌─────────▼─────────┐
         │  1. Enter Query     │         │          │ - View History    │
         │  2. Select Depth    │         │          │ - Search Sessions │
         │  3. Upload Files    │         │          │ - Export Results  │
         │  4. Set Options     │         │          │ - Delete Sessions │
         │  5. Submit          │         │          └───────────────────┘
         └──────────┬──────────┘         │
                    │                    │
         ┌──────────▼──────────┐         │          ┌────────────────────┐
         │ POST /api/v1/       │         │          │   DOCUMENTS TAB    │
         │    research/start   │         │          ├────────────────────┤
         └──────────┬──────────┘         │          │ - View Uploads     │
                    │                    │          │ - Upload New       │
         ┌──────────▼──────────┐         │          │ - Delete Documents │
         │  Get job_id         │         │          └────────────────────┘
         └──────────┬──────────┘         │
                    │                    │
         ┌──────────▼──────────┐         │
         │ Create WebSocket    │◄────────┘
         │    Connection       │
         │ ws://.../:jobId/    │
         │       stream        │
         └──────────┬──────────┘
                    │
         ┌──────────▼──────────┐
         │  REAL-TIME UPDATES  │
         ├─────────────────────┤
         │ • Progress Bar      │
         │ • Step Logs         │
         │ • Tool Execution    │
         │ • Elapsed Time      │
         └──────────┬──────────┘
                    │
    ┌───────────────┴────────────────┐
    │                                │
┌───▼─────────┐            ┌─────────▼──────┐
│  COMPLETED  │            │     FAILED     │
└───┬─────────┘            └─────────┬──────┘
    │                                │
    │ ┌────────────────────┐         │
    └►│ • View Results     │         │
      │ • Export Markdown  │◄────────┘
      │ • Export JSON      │
      │ • Save to Sessions │
      └────────────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                          WEBSOCKET MESSAGE FLOW                              ║
╚══════════════════════════════════════════════════════════════════════════════╝

    Client                          Server                         Research Agent
      │                               │                                  │
      │──────WebSocket Connect────────►│                                  │
      │                               │                                  │
      │                               │◄─────Research Started────────────│
      │◄─────{"type":"progress"}──────│                                  │
      │                               │                                  │
      │                               │◄─────Step Started────────────────│
      │◄──{"type":"step_started"}────│                                  │
      │                               │                                  │
      │                               │◄─────Tool Execution──────────────│
      │◄──{"type":"tool_execution"}──│                                  │
      │                               │                                  │
      │                               │◄─────Step Completed──────────────│
      │◄──{"type":"step_completed"}──│                                  │
      │                               │                                  │
      │                               │◄─────Research Complete───────────│
      │◄─{"type":"research_completed"}│                                  │
      │                               │                                  │
      │──────Close Connection─────────►│                                  │

╔══════════════════════════════════════════════════════════════════════════════╗
║                           API REQUEST PATTERNS                               ║
╚══════════════════════════════════════════════════════════════════════════════╝

AUTHENTICATION:
┌─────────────┐      POST /api/v1/auth/register      ┌─────────────┐
│   Browser   │─────────────────────────────────────►│  API Server │
│             │◄─────────────────────────────────────│             │
└─────────────┘     { token, user }                  └─────────────┘

RESEARCH:
┌─────────────┐      POST /api/v1/research/start     ┌─────────────┐
│   Browser   │─────────────────────────────────────►│  API Server │
│             │◄─────────────────────────────────────│             │
└─────────────┘     { job_id }                       └─────────────┘

SESSIONS:
┌─────────────┐      GET /api/v1/research/sessions   ┌─────────────┐
│   Browser   │─────────────────────────────────────►│  API Server │
│             │◄─────────────────────────────────────│             │
└─────────────┘     { sessions[], pagination }       └─────────────┘

DOCUMENTS:
┌─────────────┐      POST /api/v1/documents/upload   ┌─────────────┐
│   Browser   │─────────────────────────────────────►│  API Server │
│             │◄─────────────────────────────────────│             │
└─────────────┘     { document_ids[] }               └─────────────┘

╔══════════════════════════════════════════════════════════════════════════════╗
║                         COMPONENT ARCHITECTURE                               ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────┐
│                              index.html                                      │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │  HTML Structure: Pages, Forms, Tables, Modals                          │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────┘
        │                    │                    │                    │
        │                    │                    │                    │
   ┌────▼────┐          ┌────▼────┐         ┌────▼────┐         ┌────▼────┐
   │ auth.js │          │research │         │websocket│         │ app.js  │
   │         │          │  .js    │         │  .js    │         │         │
   ├─────────┤          ├─────────┤         ├─────────┤         ├─────────┤
   │• login  │          │• start  │         │• connect│         │• init   │
   │• register│         │• status │         │• onMsg  │         │• tabs   │
   │• logout │          │• list   │         │• onProg │         │• modals │
   │• token  │          │• export │         │• onComp │         │• toast  │
   └─────────┘          └─────────┘         └─────────┘         └─────────┘
                                │
                                ▼
                        ┌──────────────┐
                        │  style.css   │
                        ├──────────────┤
                        │• Variables   │
                        │• Components  │
                        │• Responsive  │
                        │• Animations  │
                        └──────────────┘
